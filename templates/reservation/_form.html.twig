{{ form_start(form, {'attr': {'id': 'reservation-form', 'data-controller': 'reservation-form'}}) }}

<div class="form-section">
  <div class="form-section-header">
    <div class="section-icon purple"><i class="fas fa-user"></i></div>
    <div>
      <h3>Customer & Pickup</h3>
      <p style="font-size:12px;color:var(--muted);margin-top:2px;">Select the customer and set the pickup date</p>
    </div>
  </div>
  <div class="form-section-body">
    <div class="form-grid">
      <div class="form-group">
        {{ form_label(form.customer, null, {'label_attr': {'class': 'form-label'}}) }}
        {{ form_widget(form.customer, {'attr': {'class': 'form-select'}}) }}
        {{ form_errors(form.customer) }}
      </div>
      <div class="form-group">
        {{ form_label(form.pickupDate, null, {'label_attr': {'class': 'form-label'}}) }}
        {{ form_widget(form.pickupDate, {'attr': {'class': 'form-control'}}) }}
        {{ form_errors(form.pickupDate) }}
      </div>
    </div>
  </div>
</div>

<div class="form-section">
  <div class="form-section-header" style="justify-content:space-between;">
    <div style="display:flex;align-items:center;gap:12px;">
      <div class="section-icon green"><i class="fas fa-leaf"></i></div>
      <div>
        <h3>Selected Flowers</h3>
        <p style="font-size:12px;color:var(--muted);margin-top:2px;">Add flowers and set quantities for this reservation</p>
      </div>
    </div>
    <button type="button" data-reservation-form-target="addButton" data-action="reservation-form#add"
            class="btn btn-primary" style="padding:8px 16px;font-size:13px;">
      <i class="fas fa-plus"></i> Add Flower
    </button>
  </div>
  <div class="form-section-body" style="padding:0;">

    <div data-reservation-form-target="container"
         style="padding:20px;" class="space-y-4"
         data-prototype="{{ form_widget(form.reservationDetails.vars.prototype)|e('html_attr') }}"
         data-index="{{ form.reservationDetails|length > 0 ? form.reservationDetails|length : 0 }}">
      {% if form.reservationDetails|length > 0 %}
        {% for detail in form.reservationDetails %}
          <div class="flower-item" style="border:1px solid var(--border);border-radius:10px;padding:16px;background:var(--bg);">
            <div class="grid grid-cols-1 md:grid-cols-12 gap-4 items-end">
              <div class="md:col-span-6">
                {{ form_label(detail.flower, 'Flower', {'label_attr': {'class': 'form-label'}}) }}
                {{ form_widget(detail.flower, {'attr': {'class': 'form-select flower-select'}}) }}
                {{ form_errors(detail.flower) }}
              </div>
              <div class="md:col-span-3">
                {{ form_label(detail.quantity, 'Quantity', {'label_attr': {'class': 'form-label'}}) }}
                {{ form_widget(detail.quantity, {'attr': {'class': 'form-control quantity-input', 'min': 1}}) }}
                {{ form_errors(detail.quantity) }}
              </div>
              <div class="md:col-span-2">
                <div class="form-label">Subtotal</div>
                <div class="subtotal-display" style="font-size:18px;font-weight:700;color:var(--navy);">&#8369;0.00</div>
              </div>
              <div class="md:col-span-1 flex justify-end">
                <button type="button" class="remove-flower-btn" data-action="reservation-form#remove"
                        style="color:#ef4444;cursor:pointer;background:none;border:none;padding:8px;">
                  <i class="fas fa-trash" style="font-size:16px;"></i>
                </button>
              </div>
            </div>
          </div>
        {% endfor %}
      {% endif %}
    </div>

    <div data-reservation-form-target="emptyState"
         class="{% if form.reservationDetails|length > 0 %}hidden{% endif %}"
         style="text-align:center;padding:40px 20px;color:var(--muted);">
      <i class="fas fa-seedling" style="font-size:36px;color:var(--border);display:block;margin-bottom:12px;"></i>
      <p style="font-size:14px;">No flowers added yet. Click <strong>"Add Flower"</strong> to start building the order.</p>
    </div>

    <div style="margin:0 20px 20px;padding:16px 20px;background:var(--navy);border-radius:10px;color:white;display:flex;justify-content:space-between;align-items:center;">
      <span style="font-size:15px;font-weight:600;">Total Amount</span>
      <span data-reservation-form-target="total" style="font-size:24px;font-weight:800;font-family:'Bricolage Grotesque',sans-serif;">&#8369;0.00</span>
    </div>
  </div>
</div>

<div class="form-section">
  <div class="form-section-header">
    <div class="section-icon blue"><i class="fas fa-clipboard-check"></i></div>
    <div>
      <h3>Status Settings</h3>
      <p style="font-size:12px;color:var(--muted);margin-top:2px;">Set the payment and reservation status</p>
    </div>
  </div>
  <div class="form-section-body">
    <div class="form-grid">
      <div class="form-group">
        <label class="form-label"><i class="fas fa-credit-card" style="margin-right:6px;color:var(--blue);"></i>Payment Status</label>
        {{ form_widget(form.paymentStatus, {'attr': {'class': 'form-select'}}) }}
        {{ form_errors(form.paymentStatus) }}
      </div>
      <div class="form-group">
        <label class="form-label"><i class="fas fa-clipboard-list" style="margin-right:6px;color:var(--blue);"></i>Reservation Status</label>
        {{ form_widget(form.reservationStatus, {'attr': {'class': 'form-select'}}) }}
        {{ form_errors(form.reservationStatus) }}
      </div>
    </div>
  </div>
</div>

<div class="form-actions">
  <a href="{{ path('app_reservation_index') }}" class="btn btn-outline"><i class="fas fa-arrow-left"></i> Cancel</a>
  <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> {{ button_label|default('Save Reservation') }}</button>
</div>

{{ form_end(form) }}