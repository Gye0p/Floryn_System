{% extends 'base.html.twig' %}

{% block title %}{{ supplier.supplierName }} - Floryn Garden{% endblock %}
{% block page_title %}{{ supplier.supplierName }}{% endblock %}

{% block body %}
<div class="page-wrapper px-4 sm:px-6 lg:px-8">
  <nav class="breadcrumb">
    <a href="{{ path('admin_dashboard') }}"><i class="fas fa-home"></i></a>
    <span class="separator">/</span>
    <a href="{{ path('app_supplier_index') }}">Suppliers</a>
    <span class="separator">/</span>
    <span class="current">{{ supplier.supplierName }}</span>
  </nav>

  <div class="page-header">
    <div class="page-header-info">
      <div class="avatar lg" style="background:linear-gradient(135deg,#3b82f6,#1d4ed8);"><i class="fas fa-industry" style="font-size:20px;"></i></div>
      <div>
        <h1>{{ supplier.supplierName }}</h1>
        <p class="subtitle">Supplier profile, contact details, and flower catalog</p>
      </div>
    </div>
    <div class="page-header-actions">
      <a href="{{ path('app_supplier_edit', {'id': supplier.id}) }}" class="btn btn-primary"><i class="fas fa-edit"></i> Edit Supplier</a>
      <a href="{{ path('app_supplier_index') }}" class="btn btn-outline"><i class="fas fa-arrow-left"></i> Back to List</a>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <div class="lg:col-span-2 space-y-6">
      <!-- Contact Information -->
      <div class="section-card">
        <div class="section-header">
          <div class="section-icon blue"><i class="fas fa-address-card"></i></div>
          <h3>Contact Information</h3>
        </div>
        <div class="section-body">
          <div class="detail-grid cols-2">
            <div class="detail-item">
              <div class="detail-label">Supplier Name</div>
              <div class="detail-value large">{{ supplier.supplierName }}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Contact Person</div>
              <div class="detail-value"><i class="fas fa-user" style="color:var(--muted);margin-right:6px;font-size:12px;"></i>{{ supplier.contactPerson ?? 'Not specified' }}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Phone</div>
              <div class="detail-value">{% if supplier.phone %}<a href="tel:{{ supplier.phone }}" style="color:var(--blue);">{{ supplier.phone }}</a>{% else %}<span style="color:var(--muted);font-style:italic;">Not provided</span>{% endif %}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Email</div>
              <div class="detail-value">{% if supplier.email %}<a href="mailto:{{ supplier.email }}" style="color:var(--blue);">{{ supplier.email }}</a>{% else %}<span style="color:var(--muted);font-style:italic;">Not provided</span>{% endif %}</div>
            </div>
            <div class="detail-item full">
              <div class="detail-label">Address</div>
              <div class="detail-value"><i class="fas fa-map-marker-alt" style="color:var(--muted);margin-right:6px;font-size:12px;"></i>{{ supplier.address ?? 'No address on file' }}</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Supplied Flowers -->
      <div class="section-card">
        <div class="section-header">
          <div class="section-icon green"><i class="fas fa-leaf"></i></div>
          <h3>Supplied Flowers</h3>
          <span class="section-badge">{{ supplier.flowers|length }}</span>
        </div>
        <div class="section-body">
          {% if supplier.flowers|length > 0 %}
            {% for flower in supplier.flowers %}
              <div class="list-item">
                <div class="list-item-avatar" style="background:linear-gradient(135deg,#e88da0,#d65d7a);"><i class="fas fa-leaf"></i></div>
                <div class="list-item-content">
                  <div class="list-item-title">{{ flower.name }}</div>
                  <div class="list-item-subtitle">{{ flower.category }}</div>
                </div>
                <div class="list-item-actions">
                  <span class="pill {% if flower.freshnessStatus == 'Fresh' %}green{% elseif flower.freshnessStatus == 'Good' %}yellow{% elseif flower.freshnessStatus == 'Last Sale' %}orange{% else %}red{% endif %}">{{ flower.freshnessStatus }}</span>
                  <span style="font-size:13px;color:var(--muted);margin:0 8px;">{{ flower.stockQuantity }} units</span>
                  <span style="font-weight:700;color:var(--blue);margin-right:8px;">â‚±{{ flower.price|number_format(2) }}</span>
                  <a href="{{ path('app_flower_show', {'id': flower.id}) }}" class="btn btn-ghost" style="padding:4px 8px;font-size:12px;"><i class="fas fa-external-link-alt"></i></a>
                </div>
              </div>
            {% endfor %}
          {% else %}
            <div class="empty-state" style="padding:32px 16px;">
              <div class="empty-state-icon"><i class="fas fa-seedling"></i></div>
              <h3>No flowers from this supplier</h3>
              <p>Add flowers and assign this supplier to see them here</p>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="space-y-6">
      <!-- Delivery Info -->
      <div class="section-card">
        <div class="section-header">
          <div class="section-icon amber"><i class="fas fa-truck"></i></div>
          <h3>Delivery Info</h3>
        </div>
        <div class="section-body">
          <div class="detail-grid cols-1">
            <div class="detail-item">
              <div class="detail-label">Delivery Schedule</div>
              <div class="detail-value">
                {% if supplier.deliverySchedule %}
                  <span class="pill {% if 'daily' in supplier.deliverySchedule|lower %}green{% elseif 'weekly' in supplier.deliverySchedule|lower %}blue{% else %}gray{% endif %}"><i class="fas fa-clock" style="margin-right:4px;"></i>{{ supplier.deliverySchedule }}</span>
                {% else %}<span style="color:var(--muted);font-style:italic;">Not scheduled</span>{% endif %}
              </div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Date Added</div>
              <div class="detail-value">
                {% if supplier.dateAdded %}
                  {{ supplier.dateAdded|date('F j, Y') }}
                  <div style="font-size:12px;color:var(--muted);margin-top:2px;">({{ date().diff(supplier.dateAdded).days }} days ago)</div>
                {% else %}<span style="color:var(--muted);font-style:italic;">Not recorded</span>{% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Stats -->
      <div class="section-card">
        <div class="section-header">
          <div class="section-icon purple"><i class="fas fa-chart-bar"></i></div>
          <h3>Quick Stats</h3>
        </div>
        <div class="section-body">
          <div class="detail-grid cols-1">
            <div class="detail-item">
              <div class="detail-label">Supplier ID</div>
              <div class="detail-value mono">#{{ supplier.id }}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Total Flowers</div>
              <div class="detail-value large" style="color:var(--blue);">{{ supplier.flowers|length }}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Total Stock</div>
              <div class="detail-value large" style="color:var(--blue);">{% set totalStock = 0 %}{% for flower in supplier.flowers %}{% set totalStock = totalStock + flower.stockQuantity %}{% endfor %}{{ totalStock }} units</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Danger Zone -->
      <div class="danger-zone">
        <div class="danger-zone-header">
          <i class="fas fa-exclamation-triangle"></i>
          <div>
            <h4>Danger Zone</h4>
            <p>Permanently delete this supplier. This action cannot be undone.</p>
          </div>
        </div>
        <div class="danger-zone-body">
          {{ include('supplier/_delete_form.html.twig') }}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}